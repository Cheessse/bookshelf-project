{"version":3,"file":"commonHelpers.js","sources":["../src/js/home-books.js","../src/js/home-menu.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { booksByCategory, topBooks } from '../books API/books-api';\nimport { modalAboutBook } from './modal-window';\n\nconst booksContainerOne = document.querySelector('.books-container-one-cat');\nconst booksContainerAll = document.querySelector(\n  '.books-container-all-cat-block'\n);\nconst booksContainerAllTit = document.querySelector(\n  '.books-container-all-cat-title'\n);\n\nconst screenWidth = window.innerWidth;\nlet limit;\n\nfunction templateBook(book) {\n  return `<div class=\"book-item\">\n  <ul class=\"book-item-block\" data-category=\"${book._id}\">\n    <li class=\"book-item-img\">\n      <img\n        src=\"${book.book_image}\"\n        alt=\"${book.description}\"\n        srcset=\"${book.book_image}\"\n        width=\"335\"\n        height=\"485\"\n        class=\"book-image\"\n      />\n      <p class=\"hidden-overflow\">QUICK VIEW</p>\n    </li>\n    <li class=\"book-item-title\">${book.title}</li>\n    <li class=\"book-item-author\">${book.author}</li>\n  </ul>\n</div>`;\n}\n\nfunction templateBooks(books) {\n  return books.map(templateBook).join('');\n}\n\nfunction renderBooks(books, category) {\n  booksContainerOne.innerHTML = '';\n  booksContainerAll.innerHTML = '';\n  booksContainerAllTit.innerHTML = '';\n\n  const categoryText = category;\n  const words = categoryText.split(' ');\n  const lastWord = words.pop();\n  const markup =\n    `<h3 class=\"container-category-one\">${\n      words.join(' ') + ' <span class=\"last-word\">' + lastWord + '</span>'\n    }</h3>` +\n    `<div class=\"books-container-one-cat-block\">${templateBooks(books)}</div>`;\n\n  booksContainerOne.innerHTML =\n    markup +\n    `<a href=\"#anchor\">\n  <button type=\"button\" class=\"scroll-up hidden\">UP</button>\n</a>\n`;\n}\n\nfunction renderBooksAll(categories) {\n  booksContainerOne.innerHTML = '';\n  booksContainerAll.innerHTML = '';\n\n  const title = `<h2 class=\"container-title\">Best Sellers <span>Book</span></h2>`;\n  let markup = '';\n\n  categories.forEach(category => {\n    markup += `<div class=\"cat-books-btn\">\n      <h3 class=\"container-category-all\">${category.list_name}</h3>\n    <div class=\"books-container-all-cat-block-bpt\">${templateBooks(\n      category.books\n    )}</div>\n    <button type=\"button\" class=\"btn-seemore hidden\" data-category=\"${\n      category.list_name\n    }\">SEE MORE</button>\n    </div>`;\n  });\n  booksContainerAllTit.innerHTML = title;\n  booksContainerAll.innerHTML = markup;\n}\n\nexport async function loadBooks(selectedCategory) {\n  try {\n    const data = await booksByCategory(selectedCategory);\n    renderBooks(data, selectedCategory);\n  } catch (error) {\n    showError('Sorry, there are no books for these category! ', 'red', 'white');\n  }\n}\n\nexport async function loadBooksAllCat(category) {\n  try {\n    if (screenWidth >= 375 && screenWidth <= 767) {\n      limit = 1;\n    } else if (screenWidth >= 768 && screenWidth <= 1157) {\n      limit = 3;\n    } else {\n      limit = 5;\n    }\n    let topBookList = await topBooks(category, limit);\n    topBookList = topBookList.map(el => {\n      el.books = el.books.slice(0, limit);\n      return el;\n    });\n    renderBooksAll(topBookList);\n    visibBtn();\n  } catch (error) {\n    showError('Sorry, no books! ', 'red', 'white');\n  }\n}\n\nfunction visibBtn() {\n  if (limit === 1 || limit === 3 || limit === 5) {\n    showBtn();\n  } else {\n    hideBtn();\n  }\n}\n\nfunction showBtn() {\n  if (limit <= 5) {\n    const btnSeemore = document.querySelectorAll('.btn-seemore');\n    for (let i = 0; i < btnSeemore.length; i++) {\n      btnSeemore[i].classList.remove('hidden');\n    }\n  }\n}\n\nfunction hideBtn() {\n  if (limit >= 5) {\n    const btnSeemore = document.querySelectorAll('.btn-seemore');\n    for (let i = 0; i < btnSeemore.length; i++) {\n      btnSeemore[i].classList.add('hidden');\n    }\n  }\n}\n\nasync function showMoreBooks(selectedCategory) {\n  try {\n    let moreBooksBycat = await loadBooks(selectedCategory);\n    moreBooks = moreBooksBycat.map(el => {\n      el.books = el.books.slice(0, limit);\n      return el;\n    });\n    renderBooksAll(moreBooks);\n    visibBtn();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nbooksContainerAll.addEventListener('click', async event => {\n  if (event.target && event.target.classList.contains('btn-seemore')) {\n    event.preventDefault();\n    const categoryFromButton = event.target.dataset.category;\n    await showMoreBooks(categoryFromButton);\n  }\n});\n\n// ==============////////MODAL LISTENERS//////////===============\n\nbooksContainerAll.addEventListener('click', async event => {\n  if (event.target.classList.contains('book-item')) {\n    event.preventDefault();\n    const currentElem = event.target.closest('.book-item-block');\n    const bookId = currentElem.dataset.category;\n    if (bookId) {\n      const result = await modalAboutBook(bookId);\n      console.log(result);\n    }\n  }\n});\n\nbooksContainerOne.addEventListener('click', async event => {\n  event.preventDefault();\n  if (event.target.closest('.book-item')) {\n    const currentElem = event.target.closest('.book-item-block');\n    const bookId = currentElem.dataset.category;\n    if (bookId) {\n      const result = await modalAboutBook(bookId);\n      console.log(result);\n    }\n  }\n});\n\n// ==============////////IZI//////////===============\n\nfunction showError(text, bgColor, txtColor) {\n  iziToast.error({\n    position: 'topRight',\n    message: text,\n    messageColor: txtColor,\n    messageSize: '16',\n    messageLineHeight: '15',\n    backgroundColor: bgColor,\n    timeout: 5000,\n    displayMode: 2,\n    close: true,\n    closeOnEscape: true,\n    closeOnClick: true,\n  });\n}\n\n// ==============////////SCROLL//////////===============\n\nconst anchor = document.getElementById('anchor');\n\nwindow.addEventListener('scroll', () => {\n  const scrollButtons = document.querySelectorAll('.scroll-up');\n  const anchorPosition = anchor.getBoundingClientRect().top;\n  scrollButtons.forEach(button => {\n    const buttonPosition = button.getBoundingClientRect().top;\n    if (screenWidth >= 375 && screenWidth <= 767) {\n      if (Math.abs(anchorPosition - buttonPosition) <= 700) {\n        button.classList.add('hidden');\n      } else {\n        button.classList.remove('hidden');\n      }\n    } else if (screenWidth >= 768 && screenWidth <= 1157) {\n      if (Math.abs(anchorPosition - buttonPosition) <= 900) {\n        button.classList.add('hidden');\n      } else {\n        button.classList.remove('hidden');\n      }\n    } else {\n      button.classList.add('hidden');\n    }\n  });\n});\n","import { categoryList } from '../books API/books-api';\nimport { loadBooks } from './home-books';\nimport { loadBooksAllCat } from './home-books';\n\nconst categoryBlock = document.querySelector('#category-list');\nlet category;\nwindow.onload = function () {\n    const myCategoryList = document.getElementById('category-list');\n    const title = document.createElement('li');\n    title.textContent = 'ALL CATEGORIES';\n    title.id = 'title';\n    myCategoryList.appendChild(title);\n    categoryList()\n        .then(categories => {\n            categories.forEach(function (category) {\n                const paragraph = document.createElement('p'); // создаем <p> для кажд элем списка\n                paragraph.textContent = category.list_name;\n                paragraph.classList.add('p-list');\n                myCategoryList.appendChild(paragraph);\n            });\n        })\n        .catch(error => {\n            console.error('Error fetching data;', error);\n        });\n    loadBooksAllCat(category);\n};\n\ncategoryBlock.addEventListener('click', async event => {\n    event.preventDefault();\n    if (event.target.tagName === 'P') {\n        const selectedCategory = event.target.textContent;\n        loadBooks(selectedCategory);\n    } else if (event.target.id === 'title') {\n        loadBooksAllCat(category);\n    }\n});"],"names":["booksContainerOne","booksContainerAll","booksContainerAllTit","screenWidth","limit","templateBook","book","templateBooks","books","renderBooks","category","words","lastWord","markup","renderBooksAll","categories","title","loadBooks","selectedCategory","data","booksByCategory","showError","loadBooksAllCat","topBookList","topBooks","el","visibBtn","showBtn","hideBtn","btnSeemore","i","showMoreBooks","moreBooksBycat","error","event","categoryFromButton","bookId","result","modalAboutBook","text","bgColor","txtColor","iziToast","anchor","scrollButtons","anchorPosition","button","buttonPosition","categoryBlock","myCategoryList","categoryList","paragraph"],"mappings":"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"}